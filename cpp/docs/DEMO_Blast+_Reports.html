<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="dddoc_html.css" type="text/css" /><title>Blast Reports</title></head><body><table id=main_table cellspacing=0 cellpadding=0><tr><td valign=top><iframe frameborder=0 id=navigation src="INDEX_Demo_Miscellaneous.html#Blast Reports"></iframe></td><td valign=top><div id=content><div class=page_category>Example Program</div><div class=page_title>Blast Reports</div><div id=summary><div class=text>Parsing the output of BLAST call.</div></div><div class=section_headline>File "<a href="blast_report.cpp">blast_report.cpp</a>"</div><div class=codefile >A tutorial about parsing a blast report.
<table cellspacing=0 cellpadding=0 class=codefiletab><tr><td align=right class=linenumber>1</td><td class=content><nobr>#include&nbsp;&lt;iostream&gt;<br ></nobr></td></tr><tr><td align=right class=linenumber>2</td><td class=content><nobr>#include&nbsp;&lt;seqan/blast.h&gt;<br ></nobr></td></tr><tr><td align=right class=linenumber>3</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>4</td><td class=content><nobr>using&nbsp;namespace&nbsp;seqan;<br ></nobr></td></tr><tr><td align=right class=linenumber>5</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>6</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>7</td><td class=content><nobr>template&nbsp;&lt;typename&nbsp;TFile&gt;<br ></nobr></td></tr><tr><td align=right class=linenumber>8</td><td class=content><nobr>void&nbsp;read_blast_report(TFile&nbsp;&amp;&nbsp;strm)<br ></nobr></td></tr><tr><td align=right class=linenumber>9</td><td class=content><nobr>{<br ></nobr></td></tr><tr><td align=right class=linenumber>10</td><td class=content><nobr><br ></nobr></td></tr></table><div class=comment>First the type of Blast report needs to be specified.
In this case, a BlastN report is parsed and for each alignment in the report (i.e. each HSP) we choose to parse 
all the possible information delivered with the alignment (e.g. scores, percentage of gaps, orientation... see <a href="CLASS_Blast_Hsp.html" title="Object for storing Blast HSPs." >BlastHsp</a>).
</div><table cellspacing=0 cellpadding=0 class=codefiletab><tr><td align=right class=linenumber>11</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;typedef&nbsp;BlastHsp&lt;BlastN,&nbsp;FullInfo&gt;&nbsp;TBlastHsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>12</td><td class=content><nobr><br ></nobr></td></tr></table><div class=comment>The <a href="SPEC_Stream_Report.html" title="BlastReport specialization that works on a file stream (parses hits/HSPs when iterating over them)." >StreamReport</a> specialization determines that the alignments are parsed when iterating over them (i.e. only 
one alignment is stored at a time, as opposed to the <a href="SPEC_Store_Report.html" title="BlastReport specialization. Parses a Blast report and stores all hits and HSPs." >StoreReport</a> specialization).
</div><table cellspacing=0 cellpadding=0 class=codefiletab><tr><td align=right class=linenumber>13</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;typedef&nbsp;BlastReport&lt;TBlastHsp,&nbsp;StreamReport&lt;TFile&gt;&nbsp;&gt;&nbsp;TBlastReport;<br ></nobr></td></tr><tr><td align=right class=linenumber>14</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;typedef&nbsp;typename&nbsp;Hit&lt;TBlastReport&gt;::Type&nbsp;TBlastHit;<br ></nobr></td></tr><tr><td align=right class=linenumber>15</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;typedef&nbsp;typename&nbsp;Iterator&lt;TBlastReport,HitIterator&gt;::Type&nbsp;THitIterator;<br ></nobr></td></tr><tr><td align=right class=linenumber>16</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;typedef&nbsp;typename&nbsp;Iterator&lt;TBlastHit,HspIterator&gt;::Type&nbsp;THspIterator;<br ></nobr></td></tr><tr><td align=right class=linenumber>17</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>18</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;<br ></nobr></td></tr></table><div class=comment>Our Blast report object
</div><table cellspacing=0 cellpadding=0 class=codefiletab><tr><td align=right class=linenumber>19</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;TBlastReport&nbsp;blast;<br ></nobr></td></tr><tr><td align=right class=linenumber>20</td><td class=content><nobr><br ></nobr></td></tr></table><div class=comment>Counters
</div><table cellspacing=0 cellpadding=0 class=codefiletab><tr><td align=right class=linenumber>21</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;hspcount&nbsp;=&nbsp;0;<br ></nobr></td></tr><tr><td align=right class=linenumber>22</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;hitcount&nbsp;=&nbsp;0;<br ></nobr></td></tr><tr><td align=right class=linenumber>23</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;highsignif&nbsp;=&nbsp;0;<br ></nobr></td></tr><tr><td align=right class=linenumber>24</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>25</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;while(!atEnd(strm,blast))&nbsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>26</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;{<br ></nobr></td></tr></table><div class=comment>Get the current Blast report (there can be multiple reports in one file).
</div><table cellspacing=0 cellpadding=0 class=codefiletab><tr><td align=right class=linenumber>27</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read(strm,blast,Blast());<br ></nobr></td></tr><tr><td align=right class=linenumber>28</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::std::cout&nbsp;&lt;&lt;&nbsp;"Query:&nbsp;"&lt;&lt;getQueryName(blast)&nbsp;&lt;&lt;"\n";<br ></nobr></td></tr><tr><td align=right class=linenumber>29</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::std::cout&nbsp;&lt;&lt;&nbsp;"Database:&nbsp;"&lt;&lt;getDatabaseName(blast)&nbsp;&lt;&lt;"\n\n";<br ></nobr></td></tr><tr><td align=right class=linenumber>30</td><td class=content><nobr><br ></nobr></td></tr></table><div class=comment>Iterate over hits
</div><table cellspacing=0 cellpadding=0 class=codefiletab><tr><td align=right class=linenumber>31</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THitIterator&nbsp;hit_it(blast);&nbsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>32</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(;&nbsp;!atEnd(strm,hit_it);&nbsp;goNext(strm,hit_it))&nbsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>33</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>34</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++hitcount;<br ></nobr></td></tr><tr><td align=right class=linenumber>35</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TBlastHit&nbsp;hit&nbsp;=&nbsp;getValue(strm,hit_it);<br ></nobr></td></tr><tr><td align=right class=linenumber>36</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::std::cout&nbsp;&lt;&lt;&nbsp;"&nbsp;Hit:&nbsp;"&nbsp;&lt;&lt;name(hit)&nbsp;&lt;&lt;"\n\n";<br ></nobr></td></tr><tr><td align=right class=linenumber>37</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>38</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;///&nbsp;iterate&nbsp;over&nbsp;alignments&nbsp;(HSPs)<br ></nobr></td></tr><tr><td align=right class=linenumber>39</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THspIterator&nbsp;hsp_it(hit);<br ></nobr></td></tr><tr><td align=right class=linenumber>40</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(;&nbsp;!atEnd(strm,hsp_it);&nbsp;goNext(strm,hsp_it))&nbsp;<br ></nobr></td></tr><tr><td align=right class=linenumber>41</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br ></nobr></td></tr><tr><td align=right class=linenumber>42</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++hspcount;<br ></nobr></td></tr><tr><td align=right class=linenumber>43</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TBlastHsp&nbsp;hsp&nbsp;=&nbsp;getValue(strm,hsp_it);<br ></nobr></td></tr><tr><td align=right class=linenumber>44</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br ></nobr></td></tr></table><div class=comment>Do something with the alignment, e.g.
output score and length of alignment.
</div><table cellspacing=0 cellpadding=0 class=codefiletab><tr><td align=right class=linenumber>45</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::std::cout&nbsp;&lt;&lt;&nbsp;"&nbsp;&nbsp;Score&nbsp;&nbsp;=&nbsp;"&nbsp;&lt;&lt;&nbsp;getBitScore(hsp)&nbsp;&lt;&lt;&nbsp;"\n";<br ></nobr></td></tr><tr><td align=right class=linenumber>46</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::std::cout&nbsp;&lt;&lt;&nbsp;"&nbsp;&nbsp;Length&nbsp;=&nbsp;"&nbsp;&lt;&lt;&nbsp;length(hsp)&nbsp;&lt;&lt;&nbsp;"\n\n";<br ></nobr></td></tr></table><div class=comment>Count alignments with highly significant e-values.
</div><table cellspacing=0 cellpadding=0 class=codefiletab><tr><td align=right class=linenumber>47</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(getEValue(hsp)&lt;0.01)<br ></nobr></td></tr><tr><td align=right class=linenumber>48</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++highsignif;<br ></nobr></td></tr><tr><td align=right class=linenumber>49</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>50</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>51</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>52</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;}<br ></nobr></td></tr><tr><td align=right class=linenumber>53</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;::std::cout&nbsp;&lt;&lt;"Total&nbsp;number&nbsp;of&nbsp;Hits:&nbsp;"&lt;&lt;&nbsp;hitcount&lt;&lt;::std::endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>54</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;::std::cout&nbsp;&lt;&lt;"Total&nbsp;number&nbsp;of&nbsp;HSPs:&nbsp;"&lt;&lt;&nbsp;hspcount&lt;&lt;::std::endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>55</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;::std::cout&nbsp;&lt;&lt;"Number&nbsp;of&nbsp;highly&nbsp;significant&nbsp;HSPs:&nbsp;"&lt;&lt;&nbsp;highsignif&lt;&lt;::std::endl;<br ></nobr></td></tr><tr><td align=right class=linenumber>56</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>57</td><td class=content><nobr>}<br ></nobr></td></tr><tr><td align=right class=linenumber>58</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>59</td><td class=content><nobr><br ></nobr></td></tr><tr><td align=right class=linenumber>60</td><td class=content><nobr>int&nbsp;main()<br ></nobr></td></tr><tr><td align=right class=linenumber>61</td><td class=content><nobr>{<br ></nobr></td></tr><tr><td align=right class=linenumber>62</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;::std::fstream&nbsp;strm;<br ></nobr></td></tr><tr><td align=right class=linenumber>63</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;strm.open("ecoln.out",&nbsp;::std::ios_base::in&nbsp;|&nbsp;::std::ios_base::binary);<br ></nobr></td></tr><tr><td align=right class=linenumber>64</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;read_blast_report(strm);<br ></nobr></td></tr><tr><td align=right class=linenumber>65</td><td class=content><nobr>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br ></nobr></td></tr><tr><td align=right class=linenumber>66</td><td class=content><nobr>}<br ></nobr></td></tr></table></div><div class="section" id="demofor"><div class="section_headline">See</div><div class="text_block"><span class="link_text"><a href="FUNCTION.get_E_Value.html" title="The e-value associated with a Blast HSP." >getEValue</a></span>, <span class="link_text"><a href="METAFUNCTION_Hit.html" title="Blast Hit type of a Blast object." >Hit</a></span>, <span class="link_text"><a href="FUNCTION.get_Query_Name.html" title="The name (identifier) of the query in a Blast report." >getQueryName</a></span>, <span class="link_text"><a href="CLASS_Blast_Report.html" title="Object for storing Blast report information." >BlastReport</a></span>, <span class="link_text"><a href="FUNCTION.get_Database_Name.html" title="The name (identifier) of the database in a Blast report." >getDatabaseName</a></span>, <span class="link_text"><a href="FUNCTION.get_Bit_Score.html" title="The bit score associated with a Blast HSP." >getBitScore</a></span>, <span class="link_text"><a href="CLASS_Blast_Hsp.html" title="Object for storing Blast HSPs." >BlastHsp</a></span></div></div><div class=page_footline>SeqAn - Sequence Analysis Library - <a href="http://www.seqan.de">www.seqan.de</a></div><div id=page_widthblock>&nbsp;</div></div></td></tr></table><p style="font-size:50%; color: #909090">Page built @2012/03/14 16:34:45</p></body></html>